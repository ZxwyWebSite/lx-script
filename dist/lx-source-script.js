/*! For license information please see lx-source-script.js.LICENSE.txt */
(()=>{"use strict";var t,r,e,o,n={75:(t,r,e)=>{e.d(r,{EK:()=>n,R3:()=>h,an:()=>u,bD:()=>c,bH:()=>l,bl:()=>_,cY:()=>p,lm:()=>m,n9:()=>i,yN:()=>s,zf:()=>d});let o=!1;function n(){o=!0}const s=1,a={Bold:22,Faint:22,Italic:23,Underline:24,BlinkSlow:25,BlinkRapid:25,ReverseVideo:27,Concealed:28,CrossedOut:29},i=31,l=32,p=33,u=34,c=35,_=36,h=37,d=41;function m(...t){return new g(...t)}function f(t){return`[${t}m`}class g{params=[];noColor=null;constructor(...t){o&&(this.noColor=!0),this.Add(...t)}Add(...t){return this.params.push(...t),this}sequence(){return this.params.map((t=>String(t))).join(";")}Wrap(t){return this.isNoColorSet()?t:this.format()+t+this.unformat()}format(){return f(this.sequence())}unformat(){return f(this.params.map((t=>a[t]||"0")).join(";"))}DisableColor(){this.noColor=!0}EnableColor(){this.noColor=!1}isNoColorSet(){return null!==this.noColor?this.noColor:o}}},44:(t,r,e)=>{e.a(t,(async(t,r)=>{try{var o=e(510),n=e(537),s=e(75),a=e(330);const t=(t,r)=>new Promise(((e,n)=>{r.headers={"User-Agent":`Mozilla/5.0 (compatible; lx-music-${o._K?o._K:"request"}/${o.rE})`,Accept:"application/json, text/plain, */*","X-LxM-Auth":o.xf.api.pass,...r.headers},r.timeout||(r.timeout=15e3),(0,o.Em)(t,r,((t,r)=>{if(t)return n(t);e(r.body)}))})),i=async(r,e,s,a)=>{const i=(new Date).getTime(),l=`${e}/${s.hash??s.copyrightId??s.songmid}/${a}`;n.Ay.Info("创建任务: %s, 音乐信息: %O",l,s);const p=await t(`${o.xf.api.addr}${r}/${l}`,{method:"GET"});return n.Ay.Info("返回数据: %O",p,`, 耗时 ${(new Date).getTime()-i} ms`),0!==p.code&&n.Ay.Warn(`${p.code}:`,p.msg),""!==p.data?p.data:Promise.reject(p.msg)},l={musicUrl:"url",lyric:"lrc",pic:"pic"};(0,o.on)(o.MN.request,(({source:t,action:r,info:e})=>i(l[r],t,e.musicInfo,e.type))),"desktop"===o._K?console.log(`  _                ____                           \n | |   __  __     / ___|  ___  _   _ _ __ ___ ___ \n | |   \\ \\/ /  _  \\___ \\ / _ \\| | | | '__/ __/ _ \\\n | |___ >  <  (_)  ___) | (_) | |_| | | | (_|  __/\n |_____/_/\\_\\     |____/ \\___/ \\__,_|_|  \\___\\___| Beta\n${"".padEnd(56,"=")}`):(0,s.EK)(),n.Ay.SetLevel(n.J7).SetName("").Info("欢迎使用 Lx-Script 洛雪音乐自定义源脚本 ^_^");const p={};await(async()=>{const r=n.Ay.NewGroup("Init");r.Info("初始化脚本, 版本: %s, 服务端地址: %s",a.rE,o.xf.api.addr);const e=await t(o.xf.api.addr,{method:"GET",timeout:1e4});if(!e)throw"无返回数据";r.Info("获取服务端数据成功: %o, 版本: %s",e,e.version);const s=new Date-new Date(1e3*e.summary.StartAt);if(r.Info("已持续运行",String(Math.floor(s/864e5)).padStart(2,"0"),"天",String(Math.floor(s%864e5/36e5)).padStart(2,"0"),"时",String(Math.floor(s%36e5/6e4)).padStart(2,"0"),"分",String(Math.floor(s%6e4/1e3)).padStart(2,"0"),"秒,","调用:",e.summary.Accessn,"/解析:",e.summary.Request,"/成功:",e.summary.Success),e.msg!==`Hello~::^-^::~${o.xf.api.glbv}~`)throw"Api大版本不匹配，请检查服务端与脚本是否兼容！";const i=a.rE.split("."),l=e.script.ver.split(".");for(var u=0;u<3;u++){if(i[u]<l[u]){if(r.Info("发现更新, 版本: %s, 地址: %s, 强制推送: %o",e.script.ver,e.script.url,e.script.force),(0,o.tN)(o.MN.updateAlert,{log:`提示：${e.script.force?"强制":"发现"}更新：${e.script.log}`,updateUrl:o.xf.api.addr+e.script.url+"?raw"}),e.script.force)return;break}if(i[u]>l[u])break}if(e.auth.apikey&&""===o.xf.api.pass)throw"未填写请求密钥";for(const[t,r]of Object.entries(e.source))null!==r&&(p[t]={name:t,type:"music",actions:["musicUrl","pic","lyric"],qualitys:r})})(),(0,o.tN)(o.MN.inited,{status:!0,openDevTools:!0,sources:p}),r()}catch(t){r(t)}}),1)},537:(t,r,e)=>{e.d(r,{Ay:()=>i,J7:()=>n});var o=e(75);const n=3;let s=2;class a{level=null;name="";group=[];deferr=null;constructor(t,r){this.name=t,this.group=[r]}SetName(t){return this.name=t,this}SetLevel(t){return this.level=t,this}getLevel(){return null!==this.level?this.level:s}Clone(){const t=new a(this.name,this.group);return t.level=this.level,t.deferr=this.deferr,t}NewGroup(t){return this.Clone().SetGroup(t)}AddGroup(t){return this.group.push(t),this}AppGroup(t){return this.Clone().AddGroup(t)}SetGroup(t){return this.group=[t],this}println(t,...r){let e=[];var n;this.name&&e.push((0,o.lm)(o.bH,o.yN).Wrap(`[${this.name}]`)),e.push(t,(0,o.lm)(o.an,o.yN).Wrap(`${(n=new Date).getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getDate().toString().padStart(2,"0")} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}:${n.getSeconds().toString().padStart(2,"0")}`),(0,o.lm)(o.bD,o.yN).Wrap(this.group.map((t=>`[${t}]`)).join(" "))),r[0]&&e.push(r[0]);let s=[e.join(" ")];const a=r.slice(1);a&&s.push(...a),console.log(...s)}Info(...t){return this.getLevel()>=1&&this.println((0,o.lm)(o.bl,o.yN).Wrap("[Info]")+" ",...t),this}Warn(...t){return this.getLevel()>=2&&this.println((0,o.lm)(o.cY,o.yN).Wrap("[Warn]")+" ",...t),this}Error(...t){return this.getLevel()>=0&&this.println((0,o.lm)(o.n9,o.yN).Wrap("[Error]"),...t),this}Fatal(...t){throw this.getLevel()>=0&&this.println((0,o.lm)(o.zf,o.yN).Wrap("[Fatal]"),...t),null!=this.deferr&&this.deferr(),new Error(t.toString())}Debug(...t){return this.getLevel()>=n&&this.println((0,o.lm)(o.R3,o.yN).Wrap("[Debug]"),...t),this}Panic(...t){throw this.getLevel()>=0&&this.println((0,o.lm)(o.zf,o.yN).Wrap("[Panic]"),...t),new Error(t.toString())}}const i=new a("Logs","Main")},510:(t,r,e)=>{e.d(r,{Em:()=>a,MN:()=>o,_K:()=>l,on:()=>n,rE:()=>i,tN:()=>s,xf:()=>u});const{EVENT_NAMES:o,on:n,send:s,request:a,version:i,env:l}=globalThis.lx,{api:p}=globalThis.ls,u={api:{addr:p.addr,pass:p.pass,glbv:"v1"},etc:{devmode:!0}}},330:t=>{t.exports={rE:"1.1.0"}}},s={};function a(t){var r=s[t];if(void 0!==r)return r.exports;var e=s[t]={exports:{}};return n[t](e,e.exports,a),e.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",r="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",e="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",o=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},a.a=(n,s,a)=>{var i;a&&((i=[]).d=-1);var l,p,u,c=new Set,_=n.exports,h=new Promise(((t,r)=>{u=r,p=t}));h[r]=_,h[t]=t=>(i&&t(i),c.forEach(t),h.catch((t=>{}))),n.exports=h,s((n=>{var s;l=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[t])return n;if(n.then){var s=[];s.d=0,n.then((t=>{a[r]=t,o(s)}),(t=>{a[e]=t,o(s)}));var a={};return a[t]=t=>t(s),a}}var i={};return i[t]=t=>{},i[r]=n,i})))(n);var a=()=>l.map((t=>{if(t[e])throw t[e];return t[r]})),p=new Promise((r=>{(s=()=>r(a)).r=0;var e=t=>t!==i&&!c.has(t)&&(c.add(t),t&&!t.d&&(s.r++,t.push(s)));l.map((r=>r[t](e)))}));return s.r?p:a()}),(t=>(t?u(h[e]=t):p(_),o(i)))),i&&i.d<0&&(i.d=0)},a.d=(t,r)=>{for(var e in r)a.o(r,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:r[e]})},a.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);a(44)})();